<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://kit.fontawesome.com/680d57b52c.js" crossorigin="anonymous"></script>
<title>Cook Registration Form</title>
<style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            background: linear-gradient(rgba(105, 104, 102, 0.9), rgba(235, 190, 98, 0.9)), url('./img/bg-hero.jpg');
            background-position: center center;
            background-repeat: no-repeat;
            background-size: cover;
            height: 750px;
            margin-top: 100px;
        }
    
    .container {
        max-width: 500px;
        margin: 0 auto;
        padding: 20px;
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    h1 {
        text-align: center;
        color: #343a40;
    }
    form {
        margin-top: 30px;
    }
    .form-group {
        margin-bottom: 20px;
    }
    label {
        font-weight: bold;
        color: #343a40;
    }
    input[type="text"],
    input[type="email"],
    input[type="number"],
    input[type="file"] {
        width: 100%;
        padding: 10px;
        border: 1px solid #ced4da;
        border-radius: 5px;
        box-sizing: border-box;
    }
    .form-check-label {
        margin-left: 5px;
    }
    /* button[type="submit"] {
        display: block;
        width: 100%;
        padding: 10px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
    }
    button[type="submit"]:hover {
        background-color: #0056b3;
    } */
</style>
</head>
<body>
<div class="container">
    <h1>Cook Registration Form</h1>
    <form id="cookForm"  enctype="multipart/form-data" action="/api/auth/cook" method="POST" onsubmit="handleSubmit(event)">
        <div class="form-group">
            <label for="fullName">Full Name</label>
            <input type="text" id="fullName" onchange="handleInput(event)" name="fullName">
        </div>
        <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" id="email" onchange="handleInput(event)" name="email">
        </div>
        <div class="form-group">
            <label for="experience">Experience (in years)</label>
            <input type="number" id="experience" onchange="handleInput(event)" name="experience">
        </div>
        <div class="form-group">
            <label>Gender</label>
            <div class="form-check">
                <input class="form-check-input" type="radio" onchange="handleInput(event)" id="maleCheckbox" value="male" name="gender">
                <label class="form-check-label" for="maleCheckbox">
                    Male
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" onchange="handleInput(event)" id="femaleCheckbox" value="female" name="gender">
                <label class="form-check-label" for="femaleCheckbox">
                    Female
                </label>
            </div>
        </div>
        <div class="form-group">
            <label for="speciality">Speciality</label>
            <input type="text" id="speciality" onchange="handleInput(event)" name="speciality">
        </div>
        <div class="form-group">
            <label for="dish">Special Dishes</label>
            <input type="text" id="dish" onchange="handleInput(event)" name="dish">
        </div>
        <div class="form-group">
            <label for="photo">Upload Photo</label>
            <input type="file" id="photo" onchange="handleInput(event)" name="photo">
        </div>
        <button type="submit" class="btn btn-warning mx-auto d-block px-5  text-dark">Submit</button>
    </form>
</div>
<div id="cookPopup" class="popup">
    <div class="popup-content">
      <span class="close" onclick="closePopup('cookPopup')">&times;</span>
      <h2>Cook Message</h2>
      <p id="cookMessage"></p>
    </div>
</div>

<script>
    const URL = 'http://localhost:5000/api/form/cook';

    // Define initial state
    let cook = {
        fullName: '',
        email: '',
        experience: '',
        speciality: '',
        dish: '',
    };

    // Function to update user state
    function setCook(newCook) {
        cook = { ...cook, ...newCook };
    }

    // Function to handle input changes
    function handleInput(event) {
        let name = event.target.name;
        let value = event.target.value;
        setCook({
            ...cook,
            [name]: value,
        });
    }

    // Function to handle form submission
    async function handleSubmit(event) {
        event.preventDefault();

        try {
            const response = await fetch(URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(cook),
            });
            const res_data = await response.json();
            console.log('res from server', res_data);

            if (response.ok) {
                setCook({
                    fullName: '',
                    email: '',
                    experience: '',
                    speciality: '',
                    dish: '',
                });
                openPopup('cookPopup');
                document.getElementById('cookMessage').innerText = 'Cook Registered Successfully!';
                setTimeout(() => {
                    closePopup('cookPopup');
                    window.location.href = 'nextpage.html';
                }, 3000);
            } else {
                console.error('Error:', res_data.message);
                openPopup('cookPopup');
                document.getElementById('cookMessage').innerText = 'Cook Registration Unsuccessful.';
                setTimeout(() => {
                    closePopup('cookPopup');
                }, 2000);
            }
        } catch (error) {
            console.error('There was a problem with your fetch operation:', error);
            openPopup('cookPopup');
            document.getElementById('cookMessage').innerText = 'Cook Registration Unsuccessful.';
            setTimeout(() => {
                closePopup('cookPopup');
            }, 2000);
        }
    }

    // Function to open a popup
    function openPopup(popupId) {
        var popup = document.getElementById(popupId);
        popup.style.display = 'block';
    }

    // Function to close a popup
    function closePopup(popupId) {
        var popup = document.getElementById(popupId);
        popup.style.display = 'none';
    }

    // Event listener for form submission
    document.getElementById('cookForm').addEventListener('submit', handleSubmit);
    // document.getElementById('cookForm').addEventListener('submit', function(event) {
    //     event.preventDefault(); // Prevent default form submission

    //     // Get form inputs
    //     const fullName = document.getElementById('fullName').value.trim();
    //     const email = document.getElementById('email').value.trim();
    //     const experience = document.getElementById('experience').value.trim();
    //     const gender = [];
    //     if (document.getElementById('maleCheckbox').checked) {
    //         gender.push('Male');
    //     }
    //     if (document.getElementById('femaleCheckbox').checked) {
    //         gender.push('Female');
    //     }
    //     // For simplicity, we are not handling photo upload here
    //     const speciality = document.getElementById('speciality').value.trim();
    //     const dish = document.getElementById('dish').value.trim();
    //     // Store form data in session storage
    //     const formData = { fullName, email, experience, gender, speciality, dish };
    //     sessionStorage.setItem('formData', JSON.stringify(formData));

    //     // Redirect to the next page
    //     window.location.href = 'nextpage.html';
    // });

</script>
</body>
</html>
